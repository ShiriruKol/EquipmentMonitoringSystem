@{
    ViewData["Title"] = "Статистика";
}



<div class="container">
    <div class="row">
        <div class="col">
            <div class="row">
                <div class="col text-center">
                    <h4 class="h4">График прохождения ТО на разных станциях за текущий месяц</h4>
                    <input id="IDMOUNTH" class="btn btn-success" value="Получить статистику" type="button" />
                    <canvas class="my-4 w-100 chartjs-render-monitor" id="myChart1" width="1329" height="561" style="display: block; width: 1329px; height: 561px;"></canvas>
                </div>
            </div>
            <div class="row">
                <div class="col-6">
                    <h4 class="h4">Количество внеплановых ремонтов на станциях</h4>
                    <input id="IDUNP" class="btn btn-success" value="Получить статистику" type="button" />
                    <canvas class="my-4 w-100 chartjs-render-monitor" id="myChart2" style="display: block; width: 400px; height: 400px;"></canvas>
                </div>
                <div class="col-6">
                    <h4 class="h4">Количество оборудований на разных станциях</h4>
                    <input id="ID" class="btn btn-success" value="Получить статистику" type="button" />
                    <canvas class="my-4 w-100 chartjs-render-monitor" id="myChart3" style="display: block; width: 400px; height: 400px;"></canvas>
                </div>
            </div>
        </div>
    </div>
    
</div>



<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script type="text/javascript">

    $(function(){
        $("#ID").click(function(){
            $(this).attr('disabled', true); // атрибут disabled

            $.ajax({
                type:"POST",
                url: "/Statistic/GetStatistics",
                data: "",
                contextType: "application/json; charset=utf-8",
                dataType:"json",
                success: OnSuccessResult,
                error: OnError
            });

            function OnSuccessResult(data){

                var _data = data;
                var _chartLabels=_data[0];
                var _chartData=_data[1];
                
                var barColor = ["Crimson", "MediumSeaGreen", "DeepSkyBlue", "DarkOrange", "PeachPuff", "MediumPurple"];

                const ctx3 =  document.getElementById('myChart3');

                var chartOptions = {
                    responsive : false,
                    aspectRatio: 2,
                    maintainAspectRatio : false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                };

                new Chart(ctx3,
                {
                    type:"pie",
                    data:{
                        labels: _chartLabels,
                        datasets: [{
                            backgroundColor: barColor,
                            data:_chartData,
                            borderWidth: 1
                        }]
                    },
                    options: chartOptions,
                });
            }

            function OnError(err) {

            }
        });
    });

</script>


<script type="text/javascript">

    $(function () {
        $("#IDUNP").click(function () {
            $(this).attr('disabled', true); // атрибут disabled

            $.ajax({
                type: "POST",
                url: "/Statistic/GetStatisticsUplanned",
                data: "",
                contextType: "application/json; charset=utf-8",
                dataType: "json",
                success: OnSuccessResult,
                error: OnError
            });

            function OnSuccessResult(data) {

                var _data = data;
                var _chartLabels = _data[0];
                var _chartData = _data[1];

                var barColor = ["Crimson", "MediumSeaGreen", "DeepSkyBlue", "DarkOrange", "PeachPuff", "MediumPurple"];

                const ctx3 = document.getElementById('myChart2');

                var chartOptions = {
                    responsive: false,
                    aspectRatio: 2,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                };

                new Chart(ctx3,
                    {
                        type: "pie",
                        data: {
                            labels: _chartLabels,
                            datasets: [{
                                backgroundColor: barColor,
                                data: _chartData,
                                borderWidth: 1
                            }]
                        },
                        options: chartOptions,
                    });
            }

            function OnError(err) {

            }
        });
    });

</script>

<script type="text/javascript">

    $(function () {
        $("#IDMOUNTH").click(function () {
            $(this).attr('disabled', true); // атрибут disabled

            $.ajax({
                type: "POST",
                url: "/Statistic/GetStatisticsMounth",
                data: "",
                contextType: "application/json; charset=utf-8",
                dataType: "json",
                success: OnSuccessResult,
                error: OnError
            });

            function OnSuccessResult(data) {

                var _data = data;
                var _chartLabels = _data[0];
                var _chartData = _data[1];

                var barColor = ["Crimson", "MediumSeaGreen", "DeepSkyBlue", "DarkOrange", "PeachPuff", "MediumPurple"];

                const ctx3 = document.getElementById('myChart1');

                var chartOptions = {
                    responsive: false,
                    aspectRatio: 2,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                };

                new Chart(ctx3,
                    {
                        type: "bar",
                        data: {
                            labels: _chartLabels,
                            datasets: [{
                                backgroundColor: barColor,
                                data: _chartData,
                                borderWidth: 1
                            }]
                        },
                        options: chartOptions,
                    });
            }

            function OnError(err) {

            }
        });
    });

</script>